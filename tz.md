# Техническое задание
# "strategy"
Версия 1.0

## Содержание:
1. Термины и определения
2. Цели и задачи
3. вход в игру
  3.1 Экран входа
  3.2 Экран регистрации
4. интерфейс  
  4.1 Главное меню
  4.2 Менеджмент деревни
  4.3 Игровой интерфейс
  4.4 Интерфейс глобальной карты
  4.5 интерфейс таблицы рейтинга
5. Игровой процесс
  5.1 Общая концепция
  5.2 Геймплей
  5.3 Система юнитов
  5.4 Здания
  5.5 Бой
  5.6 Мультиплеер
  5.7 Экономическая система и улучшения зданий
  5.8 Стартовый пакет новичка
6. Пользовательские сценарии
  6.1 Вход в игру
  6.2 Регистрация
  6.3 Запуск атаки
  6.4 Сценарий пассивной атаки
  6.5 Навигация между Менеджментом деревни и Глобальной картой
  6.6 Процесс запуска атаки
  6.7 Система уведомлений о нападениях

  
---

## 1. Термины и определения

- **Игрок** – пользователь, вошедший в игру
- **Юнит** – управляемая боевая единица
- **Деревня** – база игрока на глобальной карте
- **Глобальная карта** – карта, показывающая расположение всех деревень игроков
- **Менеджмент деревни** – карта деревни игрока, на которой происходят сражения
- **Ратуша** – главное строение; при уничтожении которого признается поражение
- **Спавн** – место появления новой деревни на глобальной карте
- **Рейд** – нападение на деревню другого игрока
- **Монеты** – единственная игровая валюта

## 2. Цели и задачи

**Цель:** Разработать успешную MMO-стратегию с элементами PvP и строением базы.

**Задачи:**
1. Реализовать клиентскую часть проекта
2. Реализовать серверную часть проекта  
3. Создать глубокий, но доступный геймплей
4. Обеспечить стабильную работу мультиплеера
5. Протестировать работу приложения

## 3. Вход в игру 

### 3.1 Экран входа
Состоит из двух полей ввода:
1. Логин
2. Пароль

И кнопки:
1. "Войти"

### 3.2 Экран регистрации  
1. **Поле ввода "Логин"**
   - Валидация в реальном времени
   - Индикатор доступности логина

2. **Поле ввода "Пароль"**
   - Индикатор сложности пароля

3. **Поле ввода "Подтверждение пароля"**
   - Сравнение с исходным паролем
   - Визуальное подтверждение совпадения

4. **Кнопка "Зарегистрироваться"**
   - Активируется только при выполнении всех требований
   - Анимация процесса регистрации

### требования логина и пароля
**Требования к логину:**
- Длина: от 5 до 20 символов
- Допустимые символы: латинские буквы (a-z, A-Z), цифры (0-9), символы подчеркивания (_)
- Не должен начинаться с цифры или символа подчеркивания
- Не должен содержать пробелов и специальных символов (@, #, $, %)
- Должен быть уникальным (проверка на занятость в реальном времени)

**Требования к паролю:**
- Минимальная длина: 8 символов
- Обязательное использование символов разных регистров (A-Z, a-z)
- Обязательное наличие хотя бы одной цифры (0-9)
- Рекомендуется использование специальных символов (!@#$%^&*)
- Не должен содержать персональную информацию (логин, имя, дату рождения)

**Дополнительные элементы:**
   - Ссылка "Забыли пароль?" для восстановления доступа
   - Ссылка "Создать аккаунт" для перехода к регистрации
   - Чекбокс "Запомнить меня" для сохранения сессии

   **забыли пароль:**
    - просит ввести логин 

## 4. интерфейс

### 4.1 Главное меню
Кнопки:
1. Играть
2. Рейтинг
3. Настройки
4. выход

**Общее описание:**
Главное меню представляет собой центральный хаб для навигации по игровым разделам и доступа к основным функциям. Интерфейс отличается интуитивной понятностью и визуальной привлекательностью.

**Структура и компоновка:**

1. **Центральная панель навигации**
   - Кнопка "Играть" - переход в лобби/непосредственно в игру
   - Кнопка "Рейтинг" - просмотр таблицы лидеров
   - Кнопка "Настройки" - доступ к параметрам игры
   - Кнопка "Выход" - завершение игровой сессии

2. **Информационная панель**
   - Отображение ника текущего игрока
   - Текущий рейтинг и позиция в таблице лидеров

**Визуальные элементы и оформление:**

- **Фоновая анимация**
  - Динамичная панорама игрового мира
  - Анимированные элементы интерфейса
  - Плавные переходы между состояниями кнопок

- **Система уведомлений**
  - Визуальные индикаторы новых сообщений
  - Уведомления о завершенных строительствах
  - Предупреждения о атаках на деревню
  - Новости и события от разработчиков

**Функциональные возможности:**

- **Система профиля игрока**
  - Быстрый просмотр статистики
  - Доступ к истории сражений

[//]- **Навигационные инструменты**
  - Горячие клавиши для основных действий
  - История последних активностей
  - Быстрый поиск по игровым разделам
  - Контекстные подсказки и обучение[//]

**Технические характеристики:**

- **Производительность**
  - Время загрузки: не более 3 секунд
  - Плавность анимации: 60 FPS
  - Отклик интерфейса: < 50 мс

- **Адаптивность**
  - Поддержка разрешений от 1280×720 до 4K
  - Масштабируемость интерфейса
  - Оптимизация для различных браузеров

[/**Дополнительные элементы:**

- **Социальные функции**
  - Список онлайн-друзей
  - Гильдейские уведомления
  - Система приватных сообщений /]

[//]**Особенности пользовательского опыта:**
- Пошаговое обучение для новых игроков
- Контекстные подсказки при первом посещении разделов
- Возможность кастомизации внешнего вида меню
- Регулярные обновления контента и визуальных тем[//]

### 4.2 Менеджмент деревни (Интерфейс управления деревней)

**Общее описание:**
Менеджмент деревни представляет собой игровое пространство , разделенное на три функциональные зоны равного размера (29×29 клеток каждая). Интерфейс обеспечивает полный контроль над развитием и защитой деревни.

**Структура карты:**

| Зона | Размер | Назначение | Особенности |
|------|--------|------------|-------------|
| **Зона строительства** | 29×29 клеток | Размещение зданий и оборонительных сооружений | - Сетка с визуальным выделением клеток - Подсветка доступных/недоступных позиций - Визуализация радиуса действия оборонительных сооружений |
| **Зона размещения юнитов** | 29×29 клеток | Формирование и позиционирование армии | - Разделение на секторы для разных типов юнитов - Индикация вместимости каждого сектор - Визуальное отображение готовности юнитов |
| **Зона появления врагов** | 29×29 клеток |Нападающий игрок расставляет свои войска для атаки на деревню|

**Элементы интерфейса:**

1. **Панель строительства**
   - Категории зданий:  Оборона
   - Визуальные иконки с отображением стоимости и требований
   - Информация о времени строительства и улучшения

2. **Панель управления юнитами**
   - зажав правую кнопку мыши и обведя юнитов,можно их выделить и дать дальнейшие указания 
   - Список доступных типов юнитов с характеристиками
   - Кнопки найма/тренировки с указанием времени и стоимости
   - после найма/тренировки юнита он должен появляться в **Зона размещения юнитов**

3. **Информационная панель**
   - Текущий баланс ресурсов (монеты)
   - Лимиты строительства и вместимости
   - Таймеры текущих действий (строительство, тренировка)

4. **Инструменты навигации**
   - Приближение/отдаление камеры
   - Вращение вида на 90°/180°/270°
   - Режим сетки (вкл/выкл)
   - Кнопка быстрого сохранения расположения 

**Функциональные возможности:**

- **Система размещения объектов:**
  - перетаскивание, размещение зданий и юнитов
  - Автоматическое выравнивание по сетке
  - Валидация позиций (проверка на пересечения)
  - Предпросмотр занимаемого места

- **Управление обороной:**
  - Расстановка оборонительных сооружений по периметру
  - Настройка приоритетов целей для башен
  - Тестовый режим проверки обороны

- **Оптимизация пространства:**
  - Шаблоны и пресеты для быстрой застройки
  - Система закладок для различных конфигураций(механизм, позволяющий игроку быстро сохранять и переключаться между несколькими заранее подготовленными вариантами расстановки зданий и юнитов на своей базе(мгновенно).)

**Визуальные элементы:**
- Цветовая дифференциация зон (строительство - синие тона, армия - красные тона)
- подсказки при наведении на объекты
- Интерактивные тултипы с детальной информацией
- Эффекты выделения и подсветки активных элементов(визуальные подсказки в интерфейсе, которые помогают игроку быстро понимать, с каким объектом он взаимодействует, что можно с ним сделать и в каком состоянии он находится.)

**Технические требования:**
- Поддержка разрешения от 1280×720
- ФПС: стабильные 60 FPS
- Время отклика интерфейса: < 100 мс
- Поддержка горячих клавиш для основных операций

### 4.3 Игровой интерфейс(с мишей)
Информация о:
1. Текущем количестве монет
2. Здоровье юнитов
3. Времени похода
4. Текущих зданиях

### 4.4 Интерфейс глобальной карты

**Общее описание:**
Глобальная карта представляет собой игровое пространство, отображающее расположение всех деревень игроков. Карта реализована в виде сетки (матрицы) с клеточным разделением.

**Структура и визуализация:**
- Отображение всех деревень игроков в виде значков/иконок
- Сетка с четким клеточным разделением (квадратные клетки)
- Визуальное выделение собственной деревни игрока
- Различные статусы деревень (онлайн/оффлайн, под атакой, новичок)


**Функциональные элементы интерфейса:**

1. **Панель навигации**
   - Приближение/отдаление карты
   - Перемещение по карте (перетаскивание)
   - Кнопка быстрого перехода к своей деревне
   - Фильтры отображения (все игроки, только онлайн)

2. **Панель информации о цели**
   - Отображение информации о выбранной деревне (никнейм владельца, количество побед/поражений)
   - Кнопка "Атаковать"
   - Визуализация времени доступа к цели (если применимо)

3. **Панель управления армией**
   - Отображение текущего состава отправляемой армии
   - Расчет и отображение стоимости похода
   - Таймер перемещения армии
   - Кнопка отмены/перенаправления похода

**Ключевые функциональные возможности:**

- **Система перемещения армии:**
  - Перемещение армии в реальном времени по клеткам карты
  - Визуализация маршрута движения
  - Возможность переназначения цели атаки до столкновения
  - Отображение времени в пути

- **Логистика и снабжение:**
  - Динамический расчет стоимости содержания армии в походе
  - Визуальное предупреждение о недостатке ресурсов
  - Автоматическая остановка армии при исчерпании монет

- **Механика размещения новых игроков:**
  - Автоматический подбор места спавна с минимальным расстоянием от существующих игроков
  - Защищенная зона для новичков (невозможность атаки в течение начального периода)

**Визуальные элементы:**
- Эффекты выделения при наведении на объекты
- Интерактивные подсказки с базовой информацией

**Технические требования:**
- Поддержка одновременного отображения 100+ объектов на карте
- Время отклика на действия: < 200 мс
- Плавная анимация перемещения камеры и объектов
- Оптимизация для работы в браузере

**Особенности геймплея:**
- Возможность отмены похода до момента боевого столкновения
- Система приоритетов целей (слабые/сильные противники)
- Визуализация текущих атак на другие деревни
- Ограничение на частоту атак на одного игрока

### 4.5 Таблица рейтинга

**Общее описание:**
Таблица рейтинга представляет собой систему ранжирования игроков на основе их достижений в PvP-сражениях. Рейтинговая система стимулирует соревновательный дух и предоставляет игрокам видимые цели для развития.

**Структура рейтинговой таблицы:**

1. **Основная таблица лидеров**
   - Колонка "Место" - позиция игрока в общем зачете
   - Колонка "Никнейм" - имя игрока
   - Колонка "Количество побед" - общее число успешных атак
   - Колонка "Уровень" - текущий уровень развития деревни

2. **Секция персональной статистики**
   - Текущая позиция игрока в рейтинге
   - Количество побед/поражений за текущий сезон
   - Прогресс до следующей рейтинговой лиги
   - История последних сражений

**Функциональные элементы интерфейса:**

1. **Панель фильтрации и сортировки**
   - Сортировка по количеству побед/уровню/активности
   - Поиск конкретного игрока по нику

2. **Панель навигации по сезонам**
   - Отображение текущего сезона и времени до его завершения
   - Архив предыдущих сезонов

3. **Информационная панель наград**
   - Отображение доступных наград за текущую позицию
   - Таймер до сброса рейтинга
   - Условия получения специальных наград

**Ключевые функциональные возможности:**

- **Система подсчета очков:**
  - Базовая награда за каждую победу: +1 к рейтингу

- **Механика сезонных сбросов:**
  - Ежемесячный вайп рейтинговых очков

**Визуальные элементы:**
- иконки лиг и рангов
- Индикаторы онлайн-статуса в таблице
- Анимация изменения позиций в реальном времени

**Система наград:**

| Место | Награды |
|-------|---------|
| **1 место** | Видеопоздравление от разработчиков, эксклюзивный скин ратуши, уникальный титул |
| **Топ-10** | Премиальные скины юнитов, увеличенная награда ресурсами, специальные декорации |
| **Топ-100** | Редкие скины построек, бонус к добыче ресурсов |
| **Участники** | Ежедневные бонусы в зависимости от текущей лиги |

**Технические требования:**
- Обновление рейтинга в реальном времени
- Поддержка до 200 игроков в таблице
- Быстрый поиск и фильтрация (< 100 мс)
- Кросс-платформенная синхронизация данных

**Особенности геймплея:**
- Рейтинг не влияет на игровой процесс (баланс сил)
- Прозрачная система подсчета очков
- Защита от накрутки рейтинга

## 5. Игровой процесс

### 5.1 Общая концепция
Браузерная MMO-стратегия с элементами PvP и Tower Defense. Игроки развивают деревни, собирают армии и сражаются друг с другом.

### 5.2 Геймплей
Игрок запускает игру в браузере, входит или регистрируется. В главном меню выбирает "Играть", попадает в лобби где выбирает юнитов и начинает атаку.

### 5.3 Система юнитов

**Общее описание:**
В игре представлены 13 типов юнитов с уникальными характеристиками, стоимостью и особенностями. Юниты открываются последовательно при улучшении Казарм.

#### Характеристики юнитов:

**1. Мечник**
- **Здоровье:** 100 HP
- **Урон:** 15 DPS
- **Скорость:** 1.0 клетка/сек
- **Стоимость:** 50 монет
- **Особенности:** Стандартная пехота, сбалансированные характеристики
- **Открытие:** Казармы уровень 1

**2. Копейщик**
- **Здоровье:** 60 HP
- **Урон:** 10 DPS
- **Скорость:** 1.0 клетка/сек
- **Стоимость:** 30 монет
- **Особенности:** Противо-кавалерия (+50% урона кавалерии), может атаковать через 1 союзника
- **Открытие:** Казармы уровень 1

**3. Берсерк**
- **Здоровье:** 90 HP
- **Урон:** 35 DPS
- **Скорость:** 1.3 клетки/сек
- **Стоимость:** 120 монет
- **Особенности:** Убийца пехоты (+50% урона пехоте), получает +50% урона от стрелков
- **Открытие:** Казармы уровень 2

**4. Паладин**
- **Здоровье:** 300 HP
- **Урон:** 25 DPS
- **Скорость:** 0.7 клетки/сек
- **Стоимость:** 300 монет
- **Особенности:** Танк-лидер (исцеляет союзников на 5 HP/сек в радиусе 3 клеток)
- **Открытие:** Казармы уровень 3

**5. Страж**
- **Здоровье:** 400 HP
- **Урон:** 12 DPS
- **Скорость:** 0.5 клетки/сек
- **Стоимость:** 250 монет
- **Особенности:** Танк (принуждает 3 ближайших врага атаковать себя)
- **Открытие:** Казармы уровень 5

**6. Лучник**
- **Здоровье:** 70 HP
- **Урон:** 18 DPS
- **Скорость:** 1.0 клетка/сек
- **Дальность:** 6 клеток
- **Стоимость:** 60 монет
- **Особенности:** Базовый стрелок
- **Открытие:** Казармы уровень 1

**7. Арбалетчик**
- **Здоровье:** 110 HP
- **Урон:** 28 DPS
- **Скорость:** 0.8 клетки/сек
- **Дальность:** 5 клеток
- **Стоимость:** 150 монет
- **Особенности:** Бронебойный стрелок (игнорирует 50% брони цели)
- **Открытие:** Казармы уровень 3

**8. Всадник**
- **Здоровье:** 130 HP
- **Урон:** 20 DPS
- **Скорость:** 2.0 клетки/сек
- **Стоимость:** 140 монет
- **Особенности:** Разведчик/Налетчик (+50% урона стрелкам)
- **Открытие:** Казармы уровень 3

**9. Рыцарь**
- **Здоровье:** 180 HP
- **Урон:** 30 DPS
- **Скорость:** 1.0 клетка/сек
- **Стоимость:** 200 монет
- **Особенности:** Улучшенный мечник (+20% брони против стрелков)
- **Открытие:** Казармы уровень 4

**10. Медик**
- **Здоровье:** 80 HP
- **Урон:** 0 DPS
- **Скорость:** 1.0 клетка/сек
- **Дальность:** 4 клетки
- **Стоимость:** 100 монет
- **Особенности:** Поддержка (исцеляет 15 HP/сек одного союзника)
- **Открытие:** Казармы уровень 1

**11. Маг**
- **Здоровье:** 90 HP
- **Урон:** 40 DPS
- **Скорость:** 1.0 клетка/сек
- **Дальность:** 6 клеток
- **Стоимость:** 220 монет
- **Особенности:** Магический урон (игнорирует 70% брони)
- **Открытие:** Казармы уровень 4

**12. Призыватель**
- **Здоровье:** 70 HP
- **Урон:** 8 DPS
- **Скорость:** 0.9 клетки/сек
- **Дальность:** 3 клетки
- **Стоимость:** 180 монет
- **Особенности:** Контроль толпы (призывает 1 скелета (30 HP, 5 DPS) каждые 10 сек)
- **Открытие:** Казармы уровень 4

**13. Голем**
- **Здоровье:** 500 HP
- **Урон:** 35 DPS
- **Скорость:** 0.4 клетки/сек
- **Стоимость:** 400 монет
- **Особенности:** Магический танк (получает -80% магического урона)
- **Открытие:** Казармы уровень 5

#### Система улучшений юнитов:

**Уровень Казарм 7:**
- **Улучшение всех юнитов:** +15% к здоровью и урону
- **Открытие способностей** для элитных юнитов

**Уровень Казарм 10:**
- **Улучшение всех юнитов:** +25% к здоровью и урону
- **Открытие ультимативных способностей** для уникальных юнитов

#### Лимиты и баланс:

**Ограничения по найму:**
- **Максимум 20 юнитов** одного типа в одной армии
- **Общий лимит армии:** 50 юнитов 
- **Время тренировки:** От 30 секунд до 5 минут в зависимости от типа юнита

**Стратегические рекомендации:**
- Учет контр-юнитов при формировании отряда
- Экономическая эффективность vs боевая мощь
**Общее описание:**
максимум на карте могут быть расположенны до 50 юнитов с обеих сторон.Разблокировка новых типов юнитов происходит через улучшение Казарм. Каждый уровень Казарм открывает доступ к новым юнитам и улучшает характеристики существующих.

### 5.4 Здания

| Тип | Назначение | Размер | Прочность | Особенности |
|-----|------------|--------|-----------|-------------|
| Ратуша | Главное здание | 2×2 | Высокая | Поражение при уничтожении |
| Шахта | Добыча монет | 2×2 | Средняя | Неиссякаемый источник |
| Стены | Защита | 2x2 | Высокая | Замедление врагов |
| Башни | Защита | 1×1 | Средняя | Атака врагов |
| Казармы | Производство юнитов | 2×2 | Средняя | Открытие новых юнитов |

**Разрушение зданий**
**Общее описание:**
Все здания на карте могут быть разрушены в ходе боя, однако последствия их разрушения различаются в зависимости от типа здания.

**Типы зданий и последствия разрушения:**

**1. Ратуша:**
- **Условие поражения:** Полное разрушение означает немедленное окончание боя поражением защищающейся стороны
- **Восстановление:** Автоматическое бесплатное восстановление до 100% прочности после боя
- **Особенности:** Не может быть разрушена частично - либо цела, либо полностью уничтожена

**2. Шахта:**
- **Последствия разрушения:** Временно прекращает производство монет до восстановления
- **Восстановление:** Автоматическое восстановление после боя, стоимость зависит от уровня
- **Время простоя:** Пропорционально нанесенному урону

**3. Оборонительные сооружения (Стены, Башни):**
- **Полное разрушение:** Требуют полной перестройки после боя
- **Стоимость восстановления:** Полная стоимость постройки
- **Время восстановления:** Полное время постройки заново

**4. Казармы:**
- **Последствия разрушения:** Прекращение тренировки новых юнитов до восстановления
- **Частичное повреждение:** Увеличение времени тренировки юнитов
- **Восстановление:** Автоматическое за ресурсы, пропорционально уровню разрушения

**5. Прочие здания:**
- **Восстановление:** Все обычные здания восстанавливаются автоматически после боя
- **Стоимость:** Бесплатное восстановление в течение 1-24 часов в зависимости от урона

**Система восстановления после боя:**

**Автоматическое восстановление:**
- Запускается сразу после окончания боя
- Финансируется из текущих запасов деревни
- При недостатке ресурсов - восстановление приостанавливается

**Ручное восстановление:**
- Возможность ускорения восстановления за монеты
- Приоритетное восстановление ключевых зданий
- Опция массового восстановления всех сооружений

### 5.5 Блок карты сражений

**Общее описание:**
Карта сражений представляет собой игровое пространство для проведения рейдов и обороны деревни. Карта разделена на функциональные зоны и обеспечивает тактическое управление юнитами в реальном времени.

**Структура карты:**

| Зона | Размер | Назначение | Особенности |
|------|--------|------------|-------------|
| **Зона строительства** | 29×29 клеток | Территория защищающегося игрока | - Фиксированное расположение ратуши (верхняя часть по центру)<br>- Размещение оборонительных сооружений<br>- Стратегическое позиционирование защитных юнитов |
| **Зона размещения юнитов** | 29×29 клеток | Территория для размещения атакующих сил | - Начальная позиция атакующего игрока (нижняя часть карты)<br>- Возможность расстановки юнитов перед началом боя<br>- Визуализация зон поражения оборонительных сооружений |
| **Зона появления врагов** | 29×29 клеток | Основное поле боя | Клеточная система перемещения - Зоны специальных эффектов |

**Элементы интерфейса во время сражения:**

1. **Панель управления армией**
   - Выделение групп юнитов (зажатие правой кнопки мыши)
   - Приоритизация целей (ратуша, башни, другие здания)

2. **Тактическая панель**
   - Маркеры целей и приоритетов
   - Таймер сражения
   - Индикатор прогресса атаки/обороны(можно реализовать шкалой которая заполняется по степени нанесенного урона зданиям)

3. **Информационная панель**
   - Состав и состояние атакующих/защищающихся сил
   - Экономические показатели (расходы на содержание армии)каждый юнит имеет установленный расход на свое содержание

**Ключевые функциональные возможности:**

- **Система управления юнитами:**
  - Автоматический поиск пути (алгоритм EasyStar)
  - Ручное назначение целей для каждого юнита/группы
  - Тактическое перестроение формирований

- **Механика столкновений:**
  - Юниты являются преградами друг для друга
  - Различные типы взаимодействия между юнитами
  - Система фланговых атак и тактических преимуществ

- **Динамика боя:**
  - Реальное время выполнения приказов
  - Задержки при изменении целей

**Визуальные элементы:**
- Цветовое кодирование юнитов (свои/чужие)
- Индикаторы здоровья над объектами(можно реализовать чем больше здоровья тем ярче цввет юнита)
- Эффекты анимации атак и перемещений
- Визуализация зон поражения оборонительных сооружений
- Подсветка доступных для атаки целей

**Технические требования:**
- Стабильные 60 FPS во время массовых сражений
- Время отклика на команды: < 100 мс
- Поддержка до 100 одновременно активных юнитов
- Оптимизированные алгоритмы поиска пути

**Особенности геймплея:**
- Автоматическое ИИ-управление 
- Система награды, зависящая от нанесенного урона
- Мгновенное возвращение юнитов на базу после успешного рейда
- Ограничение на одновременные атаки одной базы

### 5.6 Мультиплеер
Игроки могут атаковать деревни друг друга. За успешные атаки начисляется рейтинг.

### 5.7 Экономическая система и улучшения зданий

**Общее описание:**
Экономика игры построена на едином ресурсе - монетах, которые добываются в шахте. Система улучшений зданий обеспечивает прогрессию игрока и стратегическое развитие деревни.

**Базовая экономическая модель:**

1. **Источники дохода:**
   - Шахта: основной источник монет (1 на деревню)
   - Успешные рейды: бонусные монеты за победы

2. **Основные расходы:**
   - Строительство новых зданий
   - Улучшение существующих построек
   - Наем и содержание армии
   - Логистика военных походов

**Система улучшений зданий:**

**Шахта:**
- **Базовые характеристики:**
  - Начальный доход: 10 монет/минуту
  - Время до первого улучшения: 2 часа
  - Максимальный уровень: 4

- **Улучшения:**
Уровень 1: +5 монет/минуту за уровень (стоимость: 100 монет )
Уровень 2: +4 монет/минуту за уровень (стоимость: 250 монет )
Уровень 3: +3 монет/минуту за уровень (стоимость: 500 монет )
Уровень 4: +2 монет/минуту за уровень (стоимость: 1000 монет)

- **Особенности:**
- Экспоненциальный рост стоимости улучшений
- Уменьшение эффективности на высоких уровнях
- Не требует апгрейда для базовой функциональности

**Ратуша:**
- **Уровни улучшения:**
- Уровень 1: разблокировка базовых построек
- Уровень 2: доступ к улучшенным юнитам
- Уровень 3: открытие дополнительных слотов строительства

- **Стоимость улучшений:**
- Уровень 2: 500  монет 
- Уровень 3: 1000 монет

**Оборонительные сооружения:**

**Стены:**
- Уровень 1: 100 HP, стоимость улучшения - 200 монет
- Уровень 2: 150 HP, стоимость улучшения - 350 монет
- Уровень 3: 220 HP, стоимость улучшения - 550 монет
- Максимальный уровень: 3 (220 HP)

**Башни:**
- **Характеристики улучшений:**
- Урон: +15% за уровень
- Скорость атаки: +10% за уровень
- Дальность: +1 клетка каждые 3 уровня
- Стоимость: 300 × текущий уровень

[//]**Казармы:**
- **Улучшения:**
- Уровень 1: разблокировка юнитов ""
- Уровень 3: разблокировка юнитов "" 
- Уровень 5: разблокировка юнитов ""
- Уровень 7: улучшение характеристик всех юнитов (+10%)
- Уровень 10: специальные способности для юнитов[//]

**Механика улучшений:**

1. **Временные затраты:**
 - Шахта: 5 минут × уровень улучшения
 - Ратуша: 10 минут × уровень улучшения
 - Оборонительные сооружения: 3 минуты × уровень
 - Казармы: 7 минут × уровень улучшения

2. **Ограничения:**
 - Одновременно можно улучшать только 1 здание
 - Требуется соответствие уровня ратуши для улучшений
 - Улучшения прерываются при атаке на деревню

3. **Визуальные изменения:**
 - Анимация процесса улучшения

**Стратегические аспекты:**

- **Приоритеты развития:**
- Ранняя игра: фокус на шахте и экономике
- Средняя игра: баланс между экономикой и обороной
- Поздняя игра: специализация под стиль игры

**Технические требования:**
- Автоматическое начисление доходов каждую минуту
- Система очереди улучшений
- Уведомления о завершении апгрейдов
- Синхронизация между клиентом и сервером

**Баланс и прогрессия:**
- Мягкие ограничения для новых игроков
- Стимулы для регулярного улучшения построек
- Прозрачная система экономических расчетов

### 5.8 Стартовый пакет новичка

**Начальная база и защита:**
- **Защита новичка:** Безопасное время для развития (невозможность атаки со стороны других игроков)
- **Базовая деревня:** Стандартный набор построек на карте 29×29 клеток

**Стартовые здания:**
- **Ратуша** (1 шт.) - расположена в верхней части карты по середине
- **Шахта** (1 шт.) - единственный источник монет (начальный уровень)
- **Базовая оборона** - минимальный набор стен и оборонительных сооружений

**Начальные ресурсы:**
- **Монеты:** Стартовый запас для первого строительства и найма армии
- **Базовые юниты:** Небольшой начальный отряд для первых атак

**Особенности стартовой позиции:**
- Автоматический подбор места спавна с минимальным расстоянием от других игроков
- Сбалансированные начальные ресурсы (одинаковые возможности для всех новичков)
- Предустановленная расстановка ключевых зданий

**Ограничения для новичков:**
- Базовый уровень всех построек

**Процесс развития новичка:**
1. Освоение интерфейса управления деревней
2. Первые улучшения шахты для увеличения добычи монет
3. Строительство дополнительных оборонительных сооружений
4. Формирование первой армии для тестовых атак
5. Изучение глобальной карты и механики рейдов

**Переход из статуса новичка(происходит после улучшения ратушы на лвл 2):**
- Автоматическое снятие защиты по истечении безопасного времени
- Сохранение всех построек и накопленных ресурсов
- Полный доступ к PvP-механикам и рейтинговой системе
### 5.9 Последствия неудачной атаки и поражения при защите

**Общее описание:**
Система потерь и наказаний за неудачные боевые действия сбалансирована для поддержания здоровой конкурентной среды.

#### Последствия для атакующего при неудачной атаке:

**1. Потери юнитов:**
- **Все юниты**, участвовавшие в атаке, уничтожаются
- **Восстановление:** Требуется полный повторный найм уничтоженных юнитов

**2. Экономические потери:**
- **Потеря ресурсов,** потраченных на содержание армии во время похода
- **Невозвратные затраты** на найм уничтоженных юнитов
- **Штраф:** 10% от стоимости отправленной армии в качестве дополнительных потерь

**3. Временные ограничения:**
- **Блокировка атак** на 30 минут после неудачного рейда
- **Ограничение:** Не более 3 атак подряд на одного игрока в течение 24 часов

#### Последствия для защищающегося при проигрыше:

**1. Экономические потери:**
- **Кража ресурсов:** Атакующий забирает 15% от текущего запаса монет
- **Максимальная сумма:** Не более 100 монет за одну атаку
- **Защитный лимит:** Минимальный остаток 100 монет гарантирован

**2. Разрушения:**
- **Оборонительные сооружения** требуют перестройки (стены, башни)
- **Обычные здания** восстанавливаются автоматически
- **Время восстановления:** Зависит от уровня разрушений

**3. Рейтинговые потери:**
- **-1 пункт рейтинга** за каждое поражение в защите

**4. Временные эффекты:**
- **Запрет на атаки:** 10 минут после поражения
- **Восстановление экономики:** +10% к производству шахты на 1 час

#### Система смягчения потерь для новых игроков:

**Защита новичков (до 72 часов):**
- **Атакующий-новичок:** Потеряет только 50% юнитов при неудаче
- **Защищающийся-новичок:** Максимальная потеря 5% ресурсов
- **Рейтинговые потери:** Не применяются в течение периода защиты

**Балансировочные механизмы:**
- **Лимит ежедневных потерь:** Не более 10 рейтинговых пунктов в сутки
- **Защита от накрутки:** Особый алгоритм обнаружения сговорных атак
- **Компенсация:** Бонусные монеты после 3 поражений подряд

**Визуальное отображение потерь:**
- счетчик потерь ресурсов
- Информационная панель с детализацией потерь
- Уведомления о рейтинговых изменениях

## 6. Пользовательские сценарии

### 6.1 Вход в игру:
1. Пользователь вводит логин и пароль
2. Нажимает "Войти"
3. Попадает в главное меню

### 6.2 Регистрация:
1. Пользователь вводит данные
2. Нажимает "Зарегистрироваться"
3. Система создает аккаунт

### 6.3 Запуск атаки:
1. В лобби выбирает юнитов
2. Нажимает "Атака"
3. Выбирает цель на глобальной карте
4. Отправляет армию

### 6.4 Сценарий пассивной атаки (игрок не действует)

**Общее поведение юнитов:**
При отсутствии команд от игрока юниты переходят в автоматический режим, руководствуясь встроенным ИИ с четкой системой приоритетов.

**Иерархия целей по приоритетам:**

1. **ПЕРВЫЙ ПРИОРИТЕТ - Самооборона**
   - Юниты атакуют вражеских юнитов, которые находятся в радиусе их атаки
   - Если враг атакует юнита - он отвечает на атаку
   - При одновременной атаке нескольких целей выбирается ближайшая

2. **ВТОРОЙ ПРИОРИТЕТ - Оборонные сооружения**
   - После очистки ближайших врагов юниты двигаются к ближайшей оборонительной башне
   - Башни атакуются в порядке их угрозы (ближайшие и наносящие наибольший урон)
   - Стены игнорируются, если есть обходной путь

3. **ТРЕТИЙ ПРИОРИТЕТ - Ратуша**
   - Когда все оборонительные сооружения уничтожены, юниты атакуют ратушу
   - На пути к ратуше юниты могут атаковать второстепенные здания, если они блокируют путь

**Тактические особенности:**

- **Поиск пути:** Используется алгоритм EasyStar для обхода препятствий
- **Групповое поведение:** Юниты одного типа стараются держаться вместе
- **Фокус огня:** Все юниты в радиусе атаки концентрируются на одной цели
- **Переключение целей:** Происходит только при появлении более приоритетной цели

**Критические ситуации:**

- **Тупиковая ситуация:** Если путь заблокирован, юниты атакуют препятствие
- **Окружение:** Юниты пытаются выйти из окружения, атакуя ближайших врагов
- **Потеря здоровья:** Юниты с низким здоровьем не меняют поведение

**Визуальные индикации:**
- Маркеры над юнитами показывают текущую цель
- Линии атаки от юнитов к целям

###  6.5 Навигация между Менеджментом деревни и Глобальной картой

**Общее описание:**
Система обеспечивает бесшовное перемещение игрока между режимом управления деревней и глобальной картой с сохранением контекста текущих действий.

**Элементы навигации:**

1. **Кнопка переключения режимов**
   - Расположение: постоянный элемент в верхней панели интерфейса
   - Визуальное оформление: иконка глобуса/дома с текстовой подписью
   - Состояния: активный/неактивный режим с цветовой индикацией

2. **Горячие клавиши**
   - G - переход на Глобальную карту
   - V - возврат в Менеджмент деревни
   - Esc - контекстное возвращение к предыдущему режиму

**Процесс перехода:**

**Из Менеджмента деревни на Глобальную карту:**
1. Игрок нажимает кнопку "Глобальная карта" или клавишу G
2. Происходит плавная анимация перехода (zoom-out)
3. Автоматическое позиционирование камеры на свою деревню
4. Сохранение состояния интерфейса управления деревней

**С Глобальной карты в Менеджмент деревни:**
1. Вариант А: Клик по иконке своей деревни → кнопка "Управление"
2. Вариант Б: Использование кнопки "Моя деревня" в интерфейсе
3. Вариант В: Горячая клавиша V из любого места глобальной карты

**Контекстные переходы:**

**После успешного рейда:**
- Автоматическое возвращение в Менеджмент деревни
- Отображение экрана результатов атаки
- Автоматическое распределение добытых ресурсов

**При атаке на деревню игрока:**
- Прямой переход из Глобальной карты на карту сражения
- После боя - возврат на Глобальную карту в точку атаки

**Во время перемещения армии:**
- Возможность переключения между режимами без прерывания похода

**Технические требования:**
- Время перехода между режимами: < 2 секунды
- Сохранение состояния интерфейса при переключениях
- Синхронизация данных в реальном времени
- Кэширование данных для мгновенного доступа

**Визуальные элементы:**
- Анимация плавного приближения/отдаления
- Индикатор загрузки при первом переходе
- Подсказки управления в углу экрана
- Визуальное выделение активного режима

**Обработка прерываний:**
- Предупреждение при переходе во время активного строительства
- Сохранение прогресса при неожиданном переключении
- Восстановление сессии после разрыва соединения

### 6.6 Процесс запуска атаки

**Общее описание:**
Процесс атаки запускается с Глобальной карты и включает несколько этапов перед началом непосредственного боя.

**Процесс запуска атаки:**

**1. Выбор цели и подтверждение:**
- Игрок выбирает деревню противника на Глобальной карте
- Нажатие кнопки "Атаковать" открывает окно подтверждения
- В окне отображается:
  - Состав защищающейся армии (разведданные)
  - Уровень оборонительных сооружений
  - Расчетное время пути
  - Стоимость похода

**2. Формирование армии:**
- армия отправляется целиком
- Расчет общей стоимости содержания армии в походе
- Предупреждение при недостатке ресурсов

**3. Запуск похода:**
- После подтверждения армия начинает движение по Глобальной карте
- Визуализация: отряд отображается как движущаяся иконка от своей деревни к цели

**4. Процесс перемещения:**
- Игрок может наблюдать за продвижением армии на Глобальной карте
- Возможность отменить поход до достижения цели

**5. Начало боя:**
- При достижении цели армия исчезает с Глобальной карты
- Запускается сцена боя на карте деревни противника
- Атакующий игрок видит анимацию "Прибытие армии":
  - Появление юнитов в зоне атаки (нижняя часть карты)
  - Краткая пауза для расстановки сил (5-10 секунд)
  - Автоматический старт боя по истечении времени

**Особенности процесса:**

**Временные затраты:**
- Минимальное время похода: 30 секунд (при минимально возможном растоянии деревень друг от друга )
- Максимальное время похода: 15 минут (дальние цели)

**Управление во время похода:**
- Отслеживание положения армии в реальном времени
- Возможность параллельных действий в Менеджменте деревни

**Техническая реализация:**
- Защита от модификации клиента
- Синхронизация состояния между участниками
- Резервное копирование данных боя

**Визуальные элементы:**
- иконка движущейся армии
- Прогресс-бар времени пути

**Обработка исключительных ситуаций:**
- Защита от атаки оффлайн-игроков
- Проверка доступности цели в момент атаки

### 6.7 Система уведомлений о нападениях

**Общее описание:**
Система информирует игрока о нападениях на его деревню во время его отсутствия в игре.

**Типы уведомлений:**

**1. Push-уведомления (вне игры):**
- **Приходят сразу** при начале нападения на деревню
- **Содержание:**
  - "Вашу деревню атакует [никнейм игрока]"
  - Время начала атаки

**2. Внутриигровые уведомления:**
- **История атак** в разделе "Журнал сражений"
- **Детальная статистика** каждого нападения
- **Визуальные отметки** на поврежденных зданиях

**Сценарий оффлайн-атаки:**

**Этап 1 - Начало атаки:**
- Игрок получает push-уведомление о начале нападения
- Уведомление приходит в течение 1-2 минут после старта атаки

**Этап 2 - Процесс боя:**
- Защиту деревни осуществляет ИИ
- Юниты и оборонительные сооружения действуют по автоматическому сценарию

**Этап 3 - Результаты атаки:**
- **Мгновенное уведомление** о результате боя:
  - "Атака отражена!" - при успешной обороне
  - "Деревня подверглась разорению" - при поражении

**Содержание отчета о нападении:**

**При успешной обороне:**
- Количество уничтоженных вражеских юнитов
- Полученные трофеи (монеты)
- Состояние оборонительных сооружений
- Урон, нанесенный атакующему

**При поражении:**
- Размер украденных ресурсов
- Уничтоженные здания
- Время восстановления поврежденных построек

**Настройки уведомлений:**

**Пользовательские настройки:**
- Возможность отключения push-уведомлений
- Настройка звуковых оповещений
- Выбор типов уведомлений (только поражения/все атаки)

**Визуальное представление:**

**При входе в игру после атаки:**
- Специальный экран "Результаты обороны"
- Анимация поврежденных/восстанавливающихся зданий
- Панель быстрого ремонта
- Кнопка просмотра детальной статистики

**В журнале сражений:**
- Хронологический список всех атак
- Фильтры по дате и результату



